Config = case erlang:function_exported(rebar3, main, 1) of
    true ->
        CONFIG;
    false ->
        [{deps, [
            {lz4, ".*",
              {git, "https://github.com/lpgauth/erlang-lz4.git", {branch, "rebar3"}}},
            {shackle, ".*",
              {git, "https://github.com/lpgauth/shackle.git", {tag, "0.5.0"}}}
        ]} | lists:keydelete(deps, 1, CONFIG)]
end,

case os:getenv("TRAVIS") of
    "true" ->
        JobId = os:getenv("TRAVIS_JOB_ID"),
        lists:keystore(coveralls_service_job_id, 1, Config, {coveralls_service_job_id, JobId});
    _ ->
        Config
end.
